<!DOCTYPE html>
<html lang="en">

<head>
  <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>IBM-Senitment Analysis</title>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>

  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <script type="text/javascript">
    // Load Charts and the corechart and barchart packages.
    google.charts.load('current', { 'packages': ['corechart', 'bar', 'line'] });

    $.ajax({
      type: "POST",
      url: "http://127.0.0.1:5000/predict",
      success: function () {
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
          csvUrl1 = 'http://localhost:3000/final_lockdown_pred.csv'
          var queryOptions1 = {
            csvColumns: ['string', 'number' /* Or whatever the columns in the CSV file are */],
            csvHasHeader: true, /* This should be false if your CSV file doesn't have a header */

          }

          var query1 = new google.visualization.Query(csvUrl1, queryOptions1);

          query1.send(handleQueryResponse1);
          drawChart2();

        }
        function handleQueryResponse1(response1) {

          if (response1.isError()) {
            alert('Error in query: ' + response1.getMessage() + ' ' + response1.getDetailedMessage());
            return;
          }

          var data_livebar = response1.getDataTable();
          var chart_livebar = new google.visualization.LineChart(document.getElementById('linechart'));
          chart_livebar.draw(data_livebar, { width: 900, height: 400 });
        }
        function drawChart2() {
          $.get("final_lockdown_pred.csv", function (csvString) {
            var arrayData = $.csv.toArrays(csvString, { onParseValue: $.csv.hooks.castToScalar });
            var data = new google.visualization.arrayToDataTable(arrayData);
            var view = new google.visualization.DataView(data);
            view.setColumns([2, 3, 4, 5, 6]);
            var chart = new google.visualization.LineChart(document.getElementById('linechart2'));
            chart.draw(view, { width: 900, height: 400 });


          });
        }

      }

    });
  </script>
</head>

<body>
  <div class="col-md-6">
    <td>
      <h3>Sentiment of people on lockdown prediction along with covid19 statistics</h3>
      <div id="linechart">

      </div>
      <div id="linechart2"></div>
    </td>
  </div>

</body>

</html>